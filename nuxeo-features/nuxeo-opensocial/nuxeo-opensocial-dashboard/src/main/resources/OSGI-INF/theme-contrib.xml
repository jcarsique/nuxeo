<?xml version="1.0"?>
<component name="org.nuxeo.opensocial.dashboard.themeContrib">

  <require>org.nuxeo.theme.core</require>
  <require>org.nuxeo.theme.fragments</require>
  <require>org.nuxeo.theme.html</require>
  <require>org.nuxeo.theme.jsf</require>

  <!-- new page in xhtml -->
  <extension target="org.nuxeo.theme.services.ThemeService" point="views">

    <!-- was fragments -->
    <view name="nuxeo5 opensocial_dashboard" template-engine="jsf-facelets">
      <format-type>widget</format-type>
      <template>incl/opensocial_dashboard.xhtml</template>
    </view>
  </extension>



  <extension target="org.nuxeo.theme.services.ThemeService" point="presets">
    <palette name="intralm background" src="presets/background.properties"
      category="background" />
  </extension>

  <!-- NEW VIEWS -->

  <extension target="org.nuxeo.theme.services.ThemeService" point="views">
    <view name="contenu principal" template-engine="jsf-facelets">
      <element-type>fragment</element-type>
      <format-type>widget</format-type>
      <template>incl/opensocial_dashboard_content.xhtml</template>
    </view>
  </extension>

  <extension target="org.nuxeo.theme.services.ThemeService" point="views">
    <view name="opensocial includes" template-engine="jsf-facelets">
      <format-type>widget</format-type>
      <template>incl/opensocial_includes.xhtml</template>
      <!-- what are these for?? -->
      <resource>jquery-1.3.2.min.js</resource>
      <resource>jquery.cookie.js</resource>
      <resource>jquery.menu.js</resource>
      <resource>thickbox.js</resource>
      <resource>initmenu.js</resource>

      <resource>reset-fonts-grids.css</resource>
      <resource>container.css</resource>
    </view>
    <view name="opensocialDashBoardNav" template-engine="jsf-facelets">
      <format-type>widget</format-type>
      <template>incl/opensocial_dashboard_nav.xhtml</template>
    </view>
  </extension>

  <!-- new resources -->
  <extension target="org.nuxeo.theme.services.ThemeService" point="resources">
    <resource name="jquery-1.3.2.min.js">
      <path>opensocial/js/jquery/jquery-1.3.2.min.js</path>
    </resource>
    <resource name="thickbox.js">
      <path>opensocial/js/jquery/thickbox.js</path>
    </resource>
    <resource name="jquery.cookie.js">
      <path>opensocial/js/jquery/jquery.cookie.js</path>
    </resource>
    <resource name="jquery.menu.js">
      <path>opensocial/js/jquery/jquery.menu.js</path>
    </resource>
    <resource name="initmenu.js">
      <path>opensocial/js/initMenu.js</path>
    </resource>
    <resource name="layoutManager.js">
      <path>opensocial/js/layoutManager.js</path>
    </resource>
    <resource name="gadgetManager.js">
      <path>opensocial/js/gadgetManager.js</path>
    </resource>
    <resource name="container.css">
      <path>opensocial/css/container.css</path>
    </resource>


    <resource name="reset-fonts-grids.css">
      <path>opensocial/css/reset-fonts-grids.css</path>
    </resource>
    <resource name="gadgets.css">
      <path>opensocial/css/gadgets.css</path>
    </resource>
  </extension>

  <!-- application settings...slight mod from original -->
  <extension target="org.nuxeo.theme.services.ThemeService"
    point="applications">

    <application root="${org.nuxeo.ecm.contextPath}"
      template-engine="jsf-facelets">

      <negotiation>
        <strategy>nuxeo5</strategy>
        <default-engine>default</default-engine>
        <default-theme>galaxy/default</default-theme>
        <default-perspective>default</default-perspective>
      </negotiation>

      <!-- Cache control for theme resources (/nxthemes-lib/) -->
      <resource-caching>
        <lifetime>36000</lifetime>
      </resource-caching>

      <!-- Cache control for theme styles (/nxthemes-css/) -->
      <style-caching>
        <lifetime>900</lifetime>
      </style-caching>

      <view id="/create_relation_search_document_popup.xhtml">
        <theme>galaxy/popup</theme>
      </view>
      <!-- bind open social dashboard to correct theme and page -->
      <view id="/opensocial_dashboard.xhtml">
        <theme>galaxy-opensocial/opensocial_dashboard</theme>
      </view>
      <view id="/view_calendar.xhtml">
        <perspective>view_calendar</perspective>
      </view>
      <view id="/print.xhtml">
        <perspective>print</perspective>
      </view>
      <view id="/editor_link_search_document.xhtml">
        <theme>galaxy/popup</theme>
      </view>
      <view id="/editor_image_upload.xhtml">
        <theme>galaxy/popup</theme>
      </view>
      <view id="/search/choose_searchscope_popup.xhtml">
        <theme>galaxy/popup</theme>
      </view>
    </application>
  </extension>

  <!--  new theme -->
  <extension target="org.nuxeo.theme.services.ThemeService" point="themes">
    <theme>
      <src>themes/theme-galaxy-opensocial.xml</src>
    </theme>
  </extension>

</component>
